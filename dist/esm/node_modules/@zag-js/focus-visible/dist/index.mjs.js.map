{"version":3,"file":"index.mjs.js","sources":["../../../../../../node_modules/@zag-js/focus-visible/dist/index.mjs"],"sourcesContent":["// src/index.ts\nvar hasSetup = false;\nvar modality = null;\nvar hasEventBeforeFocus = false;\nvar handlers = /* @__PURE__ */ new Set();\nvar isMac = typeof window !== \"undefined\" && window.navigator != null ? /^Mac/.test(window.navigator.platform) : false;\nfunction isValidKey(event) {\n  return !(event.metaKey || !isMac && event.altKey || event.ctrlKey);\n}\nfunction trigger(modality2, event) {\n  handlers.forEach((handler) => handler(modality2, event));\n}\nfunction onKeyboardEvent(event) {\n  hasEventBeforeFocus = true;\n  if (isValidKey(event)) {\n    modality = \"keyboard\";\n    trigger(\"keyboard\", event);\n  }\n}\nfunction onPointerEvent(event) {\n  modality = \"pointer\";\n  if (event.type === \"mousedown\" || event.type === \"pointerdown\") {\n    hasEventBeforeFocus = true;\n    trigger(\"pointer\", event);\n  }\n}\nfunction onWindowFocus(event) {\n  if (event.target === window || event.target === document) {\n    return;\n  }\n  if (!hasEventBeforeFocus) {\n    modality = \"keyboard\";\n    trigger(\"keyboard\", event);\n  }\n  hasEventBeforeFocus = false;\n}\nfunction onWindowBlur() {\n  hasEventBeforeFocus = false;\n}\nfunction isFocusVisible() {\n  return modality !== \"pointer\";\n}\nfunction setupGlobalFocusEvents() {\n  if (typeof window === \"undefined\" || hasSetup) {\n    return;\n  }\n  const { focus } = HTMLElement.prototype;\n  HTMLElement.prototype.focus = function focusElement(...args) {\n    hasEventBeforeFocus = true;\n    focus.apply(this, args);\n  };\n  document.addEventListener(\"keydown\", onKeyboardEvent, true);\n  document.addEventListener(\"keyup\", onKeyboardEvent, true);\n  window.addEventListener(\"focus\", onWindowFocus, true);\n  window.addEventListener(\"blur\", onWindowBlur, false);\n  if (typeof PointerEvent !== \"undefined\") {\n    document.addEventListener(\"pointerdown\", onPointerEvent, true);\n    document.addEventListener(\"pointermove\", onPointerEvent, true);\n    document.addEventListener(\"pointerup\", onPointerEvent, true);\n  } else {\n    document.addEventListener(\"mousedown\", onPointerEvent, true);\n    document.addEventListener(\"mousemove\", onPointerEvent, true);\n    document.addEventListener(\"mouseup\", onPointerEvent, true);\n  }\n  hasSetup = true;\n}\nfunction trackFocusVisible(fn) {\n  setupGlobalFocusEvents();\n  fn(isFocusVisible());\n  const handler = () => fn(isFocusVisible());\n  handlers.add(handler);\n  return () => {\n    handlers.delete(handler);\n  };\n}\nexport {\n  trackFocusVisible\n};\n//# sourceMappingURL=index.mjs.map\n"],"names":["hasSetup","modality","hasEventBeforeFocus","handlers","Set","isMac","window","navigator","test","platform","trigger","modality2","event","forEach","handler","onKeyboardEvent","metaKey","altKey","ctrlKey","isValidKey","onPointerEvent","type","onWindowFocus","target","document","onWindowBlur","isFocusVisible","trackFocusVisible","fn","focus","HTMLElement","prototype","args","apply","this","addEventListener","PointerEvent","setupGlobalFocusEvents","add","delete"],"mappings":"AACA,IAAIA,GAAW,EACXC,EAAW,KACXC,GAAsB,EACtBC,EAA2B,IAAIC,IAC/BC,EAA0B,oBAAXC,QAA8C,MAApBA,OAAOC,WAAoB,OAAOC,KAAKF,OAAOC,UAAUE,UAIrG,SAASC,EAAQC,EAAWC,GAC1BT,EAASU,SAASC,GAAYA,EAAQH,EAAWC,IACnD,CACA,SAASG,EAAgBH,GACvBV,GAAsB,EAPxB,SAAoBU,GAClB,QAASA,EAAMI,UAAYX,GAASO,EAAMK,QAAUL,EAAMM,QAC5D,CAMMC,CAAWP,KACbX,EAAW,WACXS,EAAQ,WAAYE,GAExB,CACA,SAASQ,EAAeR,GACtBX,EAAW,UACQ,cAAfW,EAAMS,MAAuC,gBAAfT,EAAMS,OACtCnB,GAAsB,EACtBQ,EAAQ,UAAWE,GAEvB,CACA,SAASU,EAAcV,GACjBA,EAAMW,SAAWjB,QAAUM,EAAMW,SAAWC,WAG3CtB,IACHD,EAAW,WACXS,EAAQ,WAAYE,IAEtBV,GAAsB,EACxB,CACA,SAASuB,IACPvB,GAAsB,CACxB,CACA,SAASwB,IACP,MAAoB,YAAbzB,CACT,CAyBA,SAAS0B,EAAkBC,IAxB3B,WACE,GAAsB,oBAAXtB,QAA0BN,EACnC,OAEF,MAAM6B,MAAEA,GAAUC,YAAYC,UAC9BD,YAAYC,UAAUF,MAAQ,YAAyBG,GACrD9B,GAAsB,EACtB2B,EAAMI,MAAMC,KAAMF,EACtB,EACER,SAASW,iBAAiB,UAAWpB,GAAiB,GACtDS,SAASW,iBAAiB,QAASpB,GAAiB,GACpDT,OAAO6B,iBAAiB,QAASb,GAAe,GAChDhB,OAAO6B,iBAAiB,OAAQV,GAAc,GAClB,oBAAjBW,cACTZ,SAASW,iBAAiB,cAAef,GAAgB,GACzDI,SAASW,iBAAiB,cAAef,GAAgB,GACzDI,SAASW,iBAAiB,YAAaf,GAAgB,KAEvDI,SAASW,iBAAiB,YAAaf,GAAgB,GACvDI,SAASW,iBAAiB,YAAaf,GAAgB,GACvDI,SAASW,iBAAiB,UAAWf,GAAgB,IAEvDpB,GAAW,CACb,CAEEqC,GACAT,EAAGF,KACH,MAAMZ,EAAU,IAAMc,EAAGF,KAEzB,OADAvB,EAASmC,IAAIxB,GACN,KACLX,EAASoC,OAAOzB,EAAQ,CAE5B"}